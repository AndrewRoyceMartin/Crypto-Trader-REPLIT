/* ==========================================================================
   Minimal Trading UI — modern, sleek, grayscale-first
   Color is reserved for P/L and warnings.
   ========================================================================== */

/* Design tokens */
:root {
  /* Neutrals */
  --bg: #f7f7f8;
  --surface: #ffffff;
  --border: #e6e8eb;
  --text: #111827;
  --muted: #6b7280;
  --shadow: 0 1px 2px rgba(0, 0, 0, 0.06);

  /* Status (limited color use) */
  --up: #16a34a;      /* profit / increase */
  --down: #dc2626;    /* loss / decrease */
  --warn: #f59e0b;    /* warnings */

  /* Radii / spacing */
  --radius: 10px;
  --sp-1: 0.25rem;
  --sp-2: 0.5rem;
  --sp-3: 0.75rem;
  --sp-4: 1rem;
  --sp-5: 1.5rem;

  /* Typography */
  --font-sans: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue",
               Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", sans-serif;
  --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}

/* Base */
*,
*::before,
*::after { box-sizing: border-box; }

html { 
  -webkit-text-size-adjust: 100%;
  scroll-behavior: smooth;
}

/* Respect user preference for reduced motion */
@media (prefers-reduced-motion: reduce) {
  html { 
    scroll-behavior: auto; 
  }
  * { 
    animation-duration: 0.001ms !important; 
    animation-iteration-count: 1 !important; 
    transition-duration: 0.001ms !important; 
  }
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
  font-family: var(--font-sans);
  line-height: 1.45;
}

/* Links (neutral) */
a { color: inherit; text-decoration: none; }
a:hover { text-decoration: underline; }

/* Navbar (keep dark, but neutral) */
.navbar,
.navbar-dark.bg-dark {
  background: #111315 !important;
  border-bottom: 1px solid #191c20;
}

/* Cards */
.card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

.card-header {
  background: var(--surface);
  border-bottom: 1px solid var(--border);
  font-weight: 600;
}

/* KPI Cards */
.kpi-card {
  display: flex;
  flex-direction: column;
  justify-content: center;
  gap: var(--sp-2);
  padding: var(--sp-4);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  background: var(--surface);
}

.kpi-card .label {
  font-size: 0.75rem;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.04em;
}

.kpi-card .value {
  font-weight: 700;
  font-size: 1.25rem;
}

/* Buttons (neutral) */
.btn {
  border-radius: 8px;
  border: 1px solid var(--border);
  background: #111;
  color: #fff;
}

.btn:hover { filter: brightness(1.08); }

.btn-outline-secondary,
.btn-light,
.btn-secondary {
  background: #fff;
  color: #111;
  border: 1px solid var(--border);
}

/* Badges (use color only for semantics) */
.badge { border-radius: 999px; font-weight: 600; color: white; }

.badge.bg-success { background: var(--up); color: white; }
.badge.bg-danger  { background: var(--down); color: white; }
.badge.bg-warning { background: var(--warn); color: white; }
.badge.bg-secondary { background: #d1d5db; color: white; }
.badge.bg-primary { background: var(--primary); color: white; }

/* Tables */
.table {
  width: 100%;
  table-layout: fixed;
  margin: 0;
  font-size: 0.875rem;
}

.table th, .table td {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: middle;
  padding: 0.55rem 0.5rem;
  border-right: 1px solid var(--border);
}

.table th:last-child,
.table td:last-child { border-right: 0; }

.table thead th {
  text-transform: uppercase;
  letter-spacing: 0.04em;
  font-size: 0.75rem;
  color: var(--muted);
  background: var(--surface);
  border-bottom: 1px solid var(--border);
}

.table-hover tbody tr:hover {
  background: #f3f4f6;
}

/* Sticky table header in scroll container */
.table-responsive {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: auto;
  max-height: 420px;
  -webkit-overflow-scrolling: touch;
}

.table-responsive thead th {
  position: sticky;
  top: 0;
  z-index: 1;
}

/* For wide data tables */
#positions-table { min-width: 960px; }

/* Open Positions table optimization for better page fitting */
#open-positions-table { 
  min-width: 1200px; 
  table-layout: fixed;
}

/* Open Positions column width optimization */
#open-positions-table th:nth-child(1) { width: 8%; }  /* Symbol */
#open-positions-table th:nth-child(2) { width: 10%; } /* Current Balance */
#open-positions-table th:nth-child(3) { width: 10%; } /* Current Value */
#open-positions-table th:nth-child(4) { width: 10%; } /* Cost Basis */
#open-positions-table th:nth-child(5) { width: 8%; }  /* Price Per Unit */
#open-positions-table th:nth-child(6) { width: 10%; } /* Market Value */
#open-positions-table th:nth-child(7) { width: 8%; }  /* P&L $ */
#open-positions-table th:nth-child(8) { width: 8%; }  /* P&L % */
#open-positions-table th:nth-child(9) { width: 10%; } /* Target Value */
#open-positions-table th:nth-child(10) { width: 8%; } /* Target P&L $ */
#open-positions-table th:nth-child(11) { width: 6%; } /* Target P&L % */
#open-positions-table th:nth-child(12) { width: 6%; } /* Days */
#open-positions-table th:nth-child(13) { width: 8%; } /* Actions */

/* Numeric alignment helpers */
.numeric, .price, .amount, .text-end { text-align: right; }
.text-center { text-align: center; }
.text-start { text-align: left; }
.text-mono, .mono { font-family: var(--font-mono); font-variant-numeric: tabular-nums; }

/* Chart containers */
.chart-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: var(--sp-4);
  min-height: 280px;
}

.chart-card canvas {
  background: #fff;
  max-width: 100% !important;
  height: auto !important;
}

/* Progress (neutral) */
.progress { height: 8px; border-radius: 999px; background: #e5e7eb; }
.progress .progress-bar { background: #9ca3af; }

/* Tooltips (neutral) */
.tooltip .tooltip-inner {
  background: #111;
  color: #fff;
  border-radius: 6px;
}

/* Status indicators (limited color use) */
.text-up, .pnl-up, .pnl-positive { color: var(--up) !important; }
.text-down, .pnl-down, .pnl-negative { color: var(--down) !important; }
.text-warn { color: var(--warn) !important; }

.bg-warn { background: color-mix(in oklab, var(--warn) 16%, white); }

/* Small status dot */
.dot {
  display: inline-block;
  width: 8px; height: 8px;
  border-radius: 50%;
  background: currentColor;
}

/* Forms (neutral) */
.form-control,
.form-select {
  border: 1px solid var(--border);
  background: #fff;
  color: var(--text);
  border-radius: 8px;
}

.form-control:focus,
.form-select:focus {
  outline: none;
  border-color: #c9ccd1;
  box-shadow: 0 0 0 3px rgba(17, 17, 17, 0.08);
}

/* Footer */
footer {
  background: #111315;
  color: #d1d5db;
  border-top: 1px solid #191c20;
}

/* Scrollbar (subtle) */
.table-responsive::-webkit-scrollbar { height: 8px; width: 8px; }
.table-responsive::-webkit-scrollbar-track { background: #f1f3f5; }
.table-responsive::-webkit-scrollbar-thumb { background: #c7ccd1; border-radius: 8px; }
.table-responsive::-webkit-scrollbar-thumb:hover { background: #b7bcc1; }

/* Utilities */
.muted { color: var(--muted); }
.small { font-size: 0.8125rem; }
.hidden { display: none !important; }
.visually-hidden {
  position:absolute !important; width:1px; height:1px; padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,0,0); border:0;
}

/* Responsive tweaks */
@media (max-width: 992px) {
  .kpi-card .value { font-size: 1.1rem; }
}
@media (max-width: 768px) {
  .kpi-card { padding: var(--sp-3); }
  .kpi-card .label { font-size: 0.7rem; }
  .kpi-card .value { font-size: 1rem; }
  #positions-table { min-width: 840px; }
}
@media (max-width: 576px) {
  .table th, .table td { padding: 0.45rem 0.4rem; font-size: 0.8rem; }
}

/* Dark Mode (system) */
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0b0c0f;
    --surface: #111418;
    --border: #1d232a;
    --text: #e5e7eb;
    --muted: #9ca3af;
    --shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
  }
  body { background: var(--bg); color: var(--text); }
  .card, .kpi-card, .chart-card { background: var(--surface); border-color: var(--border); }
  .table thead th { background: var(--surface); color: var(--muted); border-bottom-color: var(--border); }
  .table-hover tbody tr:hover { background: #161a20; }
  .table-responsive { border-color: var(--border); }
  .progress { background: #232a33; }
  .progress .progress-bar { background: #9aa0a6; }
  .form-control, .form-select { background: #0f1317; border-color: var(--border); color: var(--text); }
  .form-control:focus, .form-select:focus { box-shadow: 0 0 0 3px rgba(255,255,255,0.06); }
}

/* Optional manual dark theme toggle (add .theme-dark to <body>) */
.theme-dark {
  --bg: #0b0c0f;
  --surface: #111418;
  --border: #1d232a;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --shadow: 0 1px 2px rgba(0, 0, 0, 0.4);
}

/* Control bar styling (will be overridden by improved version below) */

/* Mobile responsiveness for control bar */
@media (max-width: 768px) {
  .control-bar .d-flex {
    flex-direction: column;
    align-items: stretch !important;
    gap: var(--sp-3);
  }
  
  .control-bar .ms-auto {
    margin-left: 0 !important;
    justify-content: center;
  }
  
  .control-bar .gap-2 {
    gap: var(--sp-2) !important;
  }
}

/* Navigation height variables */
:root { --nav-h: 56px; }
@media (min-width: 992px) { :root { --nav-h: 64px; } }

/* Improved control bar positioning */
.control-bar {
  position: sticky; 
  top: 0; 
  z-index: 1020;
  background: var(--surface);
  border-color: var(--border) !important;
}

/* Section scroll margin to avoid anchor underlap */
section[id] { 
  scroll-margin-top: calc(var(--nav-h) + 56px); 
}


/* Chart Cards */
.chart-card-body {
  min-height: 200px;
}

/* ===== Minimal Card System (scoped) ===== */
.theme-min .card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
}

.theme-min .card-header,
.theme-min .card-footer {
  background: var(--surface);
  border-color: var(--border);
}

.theme-min .card-header {
  display: flex; align-items: center; justify-content: space-between;
  gap: .5rem; padding: .75rem 1rem; min-height: 3rem;
  border-bottom: 1px solid var(--border);
}

.theme-min .card-body { padding: 1rem; }
.theme-min .card-footer { padding: .75rem 1rem; border-top: 1px solid var(--border); }

/* Neutralize any legacy bg-* on cards */
.theme-min .card[class*="bg-"] { background: var(--surface) !important; color: var(--text) !important; }
.theme-min .card .text-white, 
.theme-min .card .text-white-75 { color: var(--text) !important; }

/* Hover variant (optional) */
.theme-min .card--hover { transition: transform .12s ease, box-shadow .12s ease; }
.theme-min .card--hover:hover { transform: translateY(-2px); box-shadow: 0 6px 18px rgba(0,0,0,.08); }

/* Tables inside cards (no double borders, sticky header) */
.theme-min .card .table-responsive { border: 0; border-radius: 0; max-height: 420px; overflow: auto; }
.theme-min .card .table { margin-bottom: 0; table-layout: fixed; }
.theme-min .card .table-responsive thead th {
  position: sticky; top: 0; z-index: 1;
  background: var(--surface); border-bottom: 1px solid var(--border);
}

/* KPI cards — minimal */
.theme-min .kpi-card {
  display: flex; flex-direction: column; justify-content: center; gap: .25rem;
  padding: 1rem; border: 1px solid var(--border); border-radius: var(--radius); background: var(--surface);
  text-align: center;
}
.theme-min .kpi-card .label { font-size: .75rem; color: var(--muted); text-transform: uppercase; letter-spacing: .04em; }
.theme-min .kpi-card .value { font-weight: 700; font-size: 1.25rem; }

/* Chart cards */
.theme-min .chart-card {
  background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 1rem; min-height: 280px; display: flex; flex-direction: column;
}
.theme-min .chart-card .card-body { padding: 0; flex: 1; display: flex; }
.theme-min .chart-card canvas { background: #fff; width: 100% !important; height: auto !important; }

/* Neutral stat tiles to replace bg-light mini-cards */
.theme-min .tile {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: .5rem .6rem;
}
.theme-min .tile .small { color: var(--muted); }
.theme-min .meta { color: var(--muted); font-size: .8125rem; }

/* Meaningful Color System - Only for P&L and Warnings */
.pnl-up {
  color: #22c55e;
  font-weight: 600;
}

.pnl-down {
  color: #ef4444;
  font-weight: 600;
}

.text-warn {
  color: #f59e0b;
  font-weight: 500;
}

.text-success {
  color: #22c55e;
}

.text-danger {
  color: #ef4444;
}

.btn-success {
  background-color: #22c55e;
  border-color: #22c55e;
  color: white;
}

.btn-success:hover {
  background-color: #16a34a;
  border-color: #16a34a;
}

.btn-danger {
  background-color: #ef4444;
  border-color: #ef4444;
  color: white;
}

.btn-danger:hover {
  background-color: #dc2626;
  border-color: #dc2626;
}

.btn-warning {
  background-color: #f59e0b;
  border-color: #f59e0b;
  color: white;
}

.btn-warning:hover {
  background-color: #d97706;
  border-color: #d97706;
}

/* Dark mode parity */
@media (prefers-color-scheme: dark) {
  .theme-min .card, .theme-min .kpi-card, .theme-min .chart-card, .theme-min .tile {
    background: var(--surface); border-color: var(--border);
  }
  .theme-min .card .table-responsive thead th { background: var(--surface); border-bottom-color: var(--border); }
}

/* Navbar text styling for better contrast */
.navbar .navbar-brand {
  color: #ffffff !important;
  font-weight: 600;
}

.navbar .nav-link {
  color: #ffffff !important;
  font-weight: 500;
}

.navbar .navbar-brand:hover,
.navbar .nav-link:hover {
  color: #f8f9fa !important;
  text-decoration: none;
}

.navbar .navbar-toggler {
  border: 1px solid rgba(255, 255, 255, 0.3);
  background: transparent;
}

.navbar .navbar-toggler .icon {
  color: #ffffff !important;
  font-size: 1.25rem;
}

/* ==========================================================================
   Open Positions Table Responsive Optimization
   ========================================================================== */

/* Open Positions table responsive improvements - hide columns progressively */
@media (max-width: 992px) {
  /* Hide less critical columns on medium screens */
  #open-positions-table th:nth-child(9),  /* Target Value */
  #open-positions-table td:nth-child(9),
  #open-positions-table th:nth-child(10), /* Target P&L $ */
  #open-positions-table td:nth-child(10),
  #open-positions-table th:nth-child(11), /* Target P&L % */
  #open-positions-table td:nth-child(11) {
    display: none;
  }
  #open-positions-table { min-width: 900px; }
}

@media (max-width: 768px) {
  /* Hide even more columns on smaller screens */
  #open-positions-table th:nth-child(6),  /* Market Value */
  #open-positions-table td:nth-child(6),
  #open-positions-table th:nth-child(12), /* Days */
  #open-positions-table td:nth-child(12) {
    display: none;
  }
  #open-positions-table { min-width: 600px; }
}

@media (max-width: 576px) {
  /* Compact view for mobile */
  #open-positions-table th:nth-child(4),  /* Cost Basis */
  #open-positions-table td:nth-child(4),
  #open-positions-table th:nth-child(13), /* Actions */
  #open-positions-table td:nth-child(13) {
    display: none;
  }
  #open-positions-table { min-width: 480px; }
  #open-positions-table th, 
  #open-positions-table td { 
    padding: 0.25rem 0.3rem; 
    font-size: 0.75rem; 
  }
}

.navbar .navbar-toggler:focus {
  box-shadow: 0 0 0 0.25rem rgba(255, 255, 255, 0.25);
}

/* ==========================================================================
   Coin icons styling - OKX style
   ========================================================================== */

.coin-icon {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--surface);
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  box-shadow: var(--shadow);
}

.coin-icon i {
  line-height: 1;
}

/* Table styling improvements for coin display */
td .d-flex.align-items-center {
  gap: 0.75rem;
}

td .d-flex.align-items-center > div:last-child strong {
  font-size: 0.95rem;
  font-weight: 600;
}

td .d-flex.align-items-center > div:last-child small {
  font-size: 0.8rem;
  opacity: 0.7;
}
